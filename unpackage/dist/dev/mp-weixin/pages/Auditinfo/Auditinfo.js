(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/Auditinfo/Auditinfo"],{131:function(t,e,n){"use strict";n.r(e);var s=n(132),o=n(134);for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);n(136);var u,a=n(32),r=Object(a["default"])(o["default"],s["render"],s["staticRenderFns"],!1,null,null,null,!1,s["components"],u);r.options.__file="pages/Audit/Audit.vue",e["default"]=r.exports},132:function(t,e,n){"use strict";n.r(e);var s=n(133);n.d(e,"render",(function(){return s["render"]})),n.d(e,"staticRenderFns",(function(){return s["staticRenderFns"]})),n.d(e,"recyclableRender",(function(){return s["recyclableRender"]})),n.d(e,"components",(function(){return s["components"]}))},133:function(t,e,n){"use strict";var s;n.r(e),n.d(e,"render",(function(){return o})),n.d(e,"staticRenderFns",(function(){return u})),n.d(e,"recyclableRender",(function(){return i})),n.d(e,"components",(function(){return s}));try{s={uInput:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-input/u-input")]).then(n.bind(null,253))},uUpload:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-upload/u-upload")]).then(n.bind(null,260))},uButton:function(){return n.e("uni_modules/uview-ui/components/u-button/u-button").then(n.bind(null,267))},uToast:function(){return n.e("uni_modules/uview-ui/components/u-toast/u-toast").then(n.bind(null,207))}}}catch(a){if(-1===a.message.indexOf("Cannot find module")||-1===a.message.indexOf(".vue"))throw a;console.error(a.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var o=function(){var t=this,e=t.$createElement,n=(t._self._c,["4","5","6"].includes(t.inspectionStatus));t.$mp.data=Object.assign({},{$root:{g0:n}})},i=!1,u=[];o._withStripped=!0},134:function(t,e,n){"use strict";n.r(e);var s=n(135),o=n.n(s);for(var i in s)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return s[t]}))}(i);e["default"]=o.a},135:function(t,e,n){"use strict";(function(t){var s=n(4);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=s(n(56)),i=s(n(58)),u=n(101),a=n(41),r=s(n(36)),c=r.default.baseUrl,d={name:"AuditTn",data:function(){return{inspectionStatus:"",processInspectionId:"",props_id:"",action:c+"/common/ossUpload",fileList:[],auditingform:{processInspectionId:0,taskId:0,content:"",attachUrl:"",state:0},Upheader:{Authorization:""}}},onLoad:function(t){console.log("options",t),this.props_id=t.id,this.inspectionStatus=t.inspectionStatus,this.processInspectionId=t.processInspectionId},methods:{auditingpass:function(){this.auditingform.state=1,this.Upheader.Authorization="Bearer "+(0,a.getToken)(),this.$refs.uUpload.upload(),0==this.fileList.length?this.Submitaudit():this.$refs.uUpload.upload(),console.log(this.auditingform)},auditingdispass:function(){if(console.log("22222"),this.auditingform.state=2,this.Upheader.Authorization="Bearer "+(0,a.getToken)(),""==this.auditingform.content)return console.log("4444"),void this.$refs.uToast.show({type:"error",title:"请输入意见",message:"请输入意见",duration:1e3,iconUrl:"https://cdn.uviewui.com/uview/demo/toast/success.png"});console.log("3333"),0==this.fileList.length?this.Submitaudit():this.$refs.uUpload.upload()},uploadSuccess:function(t){this.auditingform.attachUrl=t.data,this.Submitaudit()},Submitaudit:function(){var e=this;return(0,i.default)(o.default.mark((function n(){var s,i;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.auditingform.processInspectionId=e.processInspectionId,n.next=3,(0,u.inspectioninfo)(e.processInspectionId);case 3:s=n.sent,e.auditingform.taskId=s.data.taskId,console.log("inspectioninfo",s),console.log("this.auditingform",e.auditingform),i="",n.t0=e.inspectionStatus,n.next="4"===n.t0?11:"5"===n.t0?16:"6"===n.t0?20:24;break;case 11:return console.log("66666"),n.next=14,(0,u.selfInspection)(e.auditingform);case 14:return i=n.sent,n.abrupt("break",24);case 16:return n.next=18,(0,u.inspectionstest)(e.auditingform);case 18:return i=n.sent,n.abrupt("break",24);case 20:return n.next=22,(0,u.acceptance)(e.auditingform);case 22:return i=n.sent,n.abrupt("break",24);case 24:200==i.code?(e.$refs.uToast.show({type:"success",title:i.message,message:i.message,duration:1e3,iconUrl:"https://cdn.uviewui.com/uview/demo/toast/success.png",url:"/pages/inspection/inspection",complete:function(){t.navigateBack({delta:2})}}),console.log("成功")):e.$refs.uToast.show({type:"error",title:"失败",message:i.data,duration:1e3,iconUrl:"https://cdn.uviewui.com/uview/demo/toast/success.png",url:"/pages/inspection/inspection",complete:function(){t.navigateBack({delta:2})}}),console.log("inspectionRes",i),console.log("inspectionStatus",e.inspectionStatus);case 27:case"end":return n.stop()}}),n)})))()},onchange:function(t){console.log("change",t)},onComlete:function(t,e){this.fileList=t,console.log("选择文件完毕",t,this.fileList)}}};e.default=d}).call(this,n(2)["default"])},136:function(t,e,n){"use strict";n.r(e);var s=n(137),o=n.n(s);for(var i in s)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return s[t]}))}(i);e["default"]=o.a},137:function(t,e,n){},146:function(t,e,n){"use strict";(function(t,e){var s=n(4);n(26);s(n(25));var o=s(n(147));t.__webpack_require_UNI_MP_PLUGIN__=n,e(o.default)}).call(this,n(1)["default"],n(2)["createPage"])},147:function(t,e,n){"use strict";n.r(e);var s=n(148),o=n(150);for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);n(152);var u,a=n(32),r=Object(a["default"])(o["default"],s["render"],s["staticRenderFns"],!1,null,"470422da",null,!1,s["components"],u);r.options.__file="pages/Auditinfo/Auditinfo.vue",e["default"]=r.exports},148:function(t,e,n){"use strict";n.r(e);var s=n(149);n.d(e,"render",(function(){return s["render"]})),n.d(e,"staticRenderFns",(function(){return s["staticRenderFns"]})),n.d(e,"recyclableRender",(function(){return s["recyclableRender"]})),n.d(e,"components",(function(){return s["components"]}))},149:function(t,e,n){"use strict";var s;n.r(e),n.d(e,"render",(function(){return o})),n.d(e,"staticRenderFns",(function(){return u})),n.d(e,"recyclableRender",(function(){return i})),n.d(e,"components",(function(){return s}));try{s={uForm:function(){return n.e("uni_modules/uview-ui/components/u-form/u-form").then(n.bind(null,214))},uFormItem:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-form-item/u-form-item")]).then(n.bind(null,221))},uCollapse:function(){return n.e("uni_modules/uview-ui/components/u-collapse/u-collapse").then(n.bind(null,232))},uCollapseItem:function(){return n.e("uni_modules/uview-ui/components/u-collapse-item/u-collapse-item").then(n.bind(null,239))},uTag:function(){return n.e("uni_modules/uview-ui/components/u-tag/u-tag").then(n.bind(null,193))},uniDataSelect:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-data-select/components/uni-data-select/uni-data-select")]).then(n.bind(null,330))},uInput:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-input/u-input")]).then(n.bind(null,253))},uUpload:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-upload/u-upload")]).then(n.bind(null,260))},uToast:function(){return n.e("uni_modules/uview-ui/components/u-toast/u-toast").then(n.bind(null,207))},uPopup:function(){return n.e("uni_modules/uview-ui/components/u-popup/u-popup").then(n.bind(null,274))}}}catch(a){if(-1===a.message.indexOf("Cannot find module")||-1===a.message.indexOf(".vue"))throw a;console.error(a.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var o=function(){var t=this,e=t.$createElement,n=(t._self._c,{color:"#181818","font-size":"16px",position:"relative","font-weight":"500","padding-left":"20px"}),s=t.flgs&&t.flgsss?4==t.addform.taskStatus&&t.checkPermi(["beam:inspection:selfInspection"]):null,o=t.flgs&&t.flgsss?5==t.addform.taskStatus&&t.checkPermi(["beam:inspection:test"]):null,i=t.flgs&&t.flgsss?6==t.addform.taskStatus&&t.checkPermi(["beam:inspection:acceptance"]):null;t._isMounted||(t.e0=function(e){t.show=!0}),t.$mp.data=Object.assign({},{$root:{a0:n,m0:s,m1:o,m2:i}})},i=!1,u=[];o._withStripped=!0},150:function(t,e,n){"use strict";n.r(e);var s=n(151),o=n.n(s);for(var i in s)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return s[t]}))}(i);e["default"]=o.a},151:function(t,e,n){"use strict";(function(t){var s=n(4);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=s(n(11)),i=n(84),u=s(n(131)),a=n(101),r=n(41),c=n(102),d=s(n(36));function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){(0,o.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var p=d.default.baseUrl,m={name:"AuditnInfo",components:{AuditTn:u.default},props:{},data:function(){return{inspectionStatus:"",processInspectionId:"",props_id:"",fileList:[],auditingform:{processInspectionId:0,taskId:0,content:"",attachUrl:"",state:0},Upheader:{Authorization:"Bearer "+(0,r.getToken)()},action:p+"/common/ossUpload",form:{},id:"",show:!1,addform:{},freelist:[],banlist:[],alllist:[],mobanlist:[],yanstatus:[{text:"合格",value:1},{text:"不合格",value:2}],processList:[],haveprocessList:[],flgs:!0,flgsss:!0,showtime:!1}},onBackPress:function(e){return t.redirectTo({url:"/pages/inspection/inspection"}),!0},onLoad:function(t){this.inspectionStatus=t.inspectionStatus,this.processInspectionId=t.processInspectionId,this.id=t.id,t.showcheck?this.flgsss=!1:this.flgsss=!0},mounted:function(){var t=this;!this.id&&(this.id=this.props_id,this.flgsss=!1),this.getlist(),(0,i.freetailist)(this.id).then((function(e){e.data.map((function(e){t.freelist.push({text:e.seatCode,value:e.seatId})}))})),(0,i.banlisu)().then((function(e){e.data.map((function(e){t.banlist.push({text:e.deptName,value:e.deptId})}))})),(0,i.mulist)().then((function(e){e.data.items.map((function(e){t.mobanlist.push({text:e.templateNumber,value:e.templateId})}))}))},methods:{checkPermi:c.checkPermi,getlist:function(){var t=this;this.haveprocessList=[];(0,i.beamsinfo)(this.id).then((function(e){t.form=e.data,(0,i.listsettingss)(e.data.methodSettingsId).then((function(n){t.processList=n.data.processList,(0,i.settingoff)({taskNo:e.data.taskNo}).then((function(e){if(e.data){e.data.map((function(e){7==e.taskStatus&&t.haveprocessList.push(e)}));var n=JSON.stringify(e.data);t.addform=t.processList[e.data.length];var s=JSON.parse(n).pop();7==s.taskStatus&&t.haveprocessList.length!=t.processList.length?(t.addform.deptId="",t.addform.deptName="",t.addform.seatId="",t.addform.templateId="",t.addform.inspectStatus=""):t.addform=f(f({},t.addform),s);var o=!0;o=null!=t.haveprocessList&&t.haveprocessList.length!=t.processList.length||t.haveprocessList.length==t.processList.length&&3!=t.haveprocessList[t.processList.length-1].taskStatus,t.flgs=o}else t.haveprocessList=[],t.addform=t.processList[0],t.flgs=!0}))}))})),this.$delete(this.fileList,0)},goback:function(){t.reLaunch({url:"/pages/inspection/inspection"})},firstsend:function(){var e=this;this.addform.planId=this.form.planId,(0,i.firsttasks)(this.addform).then((function(n){200==n.code&&(t.showToast({title:"派发成功"}),e.getlist())}))},sencendbtn:function(){var e=this;this.addform.planId=this.form.planId,(0,i.sentedtasks)(this.addform).then((function(n){200==n.code&&(t.showToast({title:"成功"}),e.getlist())}))},depname:function(t){var e=this;this.banlist.map((function(n){n.value==t&&(e.addform.deptName=n.text)}))},betime:function(t){this.addform.beginTime=t.result},auditingpass:function(e){var n=this;this.addform.state=1,this.$nextTick((function(){4==e?(0,a.selfInspection)(n.addform).then((function(e){200==e.code&&(n.$refs.uToast.show({type:"success",title:"成功",message:"成功",duration:1e3,iconUrl:"https://cdn.uviewui.com/uview/demo/toast/success.png"}),t.reLaunch({url:"/pages/inspection/inspection"}))})):5==e?(0,a.inspectionstest)(n.addform).then((function(e){200==e.code&&(n.$refs.uToast.show({type:"success",title:"成功",message:"成功",duration:1e3,iconUrl:"https://cdn.uviewui.com/uview/demo/toast/success.png"}),t.reLaunch({url:"/pages/inspection/inspection"}))})):6==e&&(0,a.acceptance)(n.addform).then((function(e){200==e.code&&(n.$refs.uToast.show({type:"success",title:"成功",message:"成功",duration:1e3,iconUrl:"https://cdn.uviewui.com/uview/demo/toast/success.png"}),t.reLaunch({url:"/pages/inspection/inspection"}))}))}))},auditingdispass:function(e){var n=this;this.addform.state=2,this.$nextTick((function(){if(!n.addform.content)return t.showToast({icon:"error",title:"请输入审核意见"}),!1;4==e?(0,a.selfInspection)(n.addform).then((function(e){200==e.code&&200==e.code&&(t.showToast({title:e.message}),t.reLaunch({url:"/pages/inspection/inspection"}))})):5==e?(0,a.inspectionstest)(n.addform).then((function(e){200==e.code&&(t.showToast({title:e.message}),t.reLaunch({url:"/pages/inspection/inspection"}))})):6==e&&(0,a.acceptance)(n.addform).then((function(e){200==e.code&&(t.showToast({title:e.message}),t.reLaunch({url:"/pages/inspection/inspection"}))}))}))},uploadSuccess:function(t){this.addform.attachUrl=t.data},onComlete:function(t,e){this.fileList=t,this.$refs.uUpload.upload()},goupback:function(){t.navigateBack({delta:1})}}};e.default=m}).call(this,n(2)["default"])},152:function(t,e,n){"use strict";n.r(e);var s=n(153),o=n.n(s);for(var i in s)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return s[t]}))}(i);e["default"]=o.a},153:function(t,e,n){}},[[146,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/Auditinfo/Auditinfo.js.map